<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login — Jody Graham</title>
<link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
<header>
  <div class="wrap nav">
    <a class="brand" href="index.html">Jody Graham</a>
    <button class="menu-toggle" aria-expanded="false" aria-controls="mainmenu">Menu</button>
    <nav id="mainmenu" class="menu">
      <a href="index.html">Home</a><a href="gallery.html">Gallery</a><a href="virtual.html">Virtual Gallery</a>
      <a href="teaching.html">Learn</a><a href="pricing.html">Pricing</a><a href="about.html">About</a>
      <a href="press.html">Press</a><a href="contact.html">Contact</a><a href="login.html" aria-current="page">Login</a>
    </nav>
  </div>
</header>

<section class="wrap" style="max-width:640px">
  <h2>Member Login</h2>

  <div class="list">
    <!-- GUEST VIEW -->
    <article class="item" data-guest>
      <form id="loginForm" onsubmit="authLogin(event)">
        <label for="loginEmail">Email</label>
        <input id="loginEmail" type="email" autocomplete="username" required
               style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--stroke)">

        <div style="height:10px"></div>

        <label for="loginPass">Password</label>
        <input id="loginPass" type="password" autocomplete="current-password" required minlength="8"
               style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--stroke)">

        <!-- message area gets inserted just below this form by auth.js/diagnostics -->
        <div style="height:14px"></div>

        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" type="submit">Log in</button>
          <button class="btn" type="button" onclick="authSignup(event)">Sign up</button>
          <a class="btn" href="#" onclick="authResetPassword();return false;">Forgot password</a>
        </div>
        <p class="lede">New here? Press “Sign up” to create an account.</p>
      </form>
    </article>

    <!-- MEMBER VIEW -->
    <article class="item" data-member style="display:none">
      <p>You’re logged in as <strong id="whoami">Member</strong>.</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn ok" href="member.html">Go to Member Area</a>
        <button class="btn" type="button" onclick="authLogout()">Log out</button>
      </div>
    </article>
  </div>
</section>

<footer><div class="wrap">© <span id="y"></span> Jody Graham. All rights reserved.</div></footer>

<!-- Your site JS (menu etc.) -->
<script src="assets/app.js"></script>
<!-- Supabase auth (must be after app.js) -->
<script src="assets/auth.js"></script>

<!-- Light diagnostics so errors show on the page (handy on iPad) -->
<script>
  function _inlineMsg(msg, good){
    var m = document.getElementById('authMsg') || (function(){
      var d=document.createElement('div'); d.id='authMsg';
      d.style.margin='12px 0'; d.style.padding='10px'; d.style.borderRadius='8px';
      d.style.fontSize='14px'; d.style.display='block';
      var form=document.getElementById('loginForm'); form.parentNode.insertBefore(d, form.nextSibling);
      return d;
    })();
    if(good){
      m.style.color='#e7fff0'; m.style.background='rgba(50,215,75,.08)'; m.style.border='1px solid rgba(50,215,75,.45)';
    } else {
      m.style.color='#fff1f1'; m.style.background='rgba(255,69,58,.10)'; m.style.border='1px solid rgba(255,69,58,.45)';
    }
    m.textContent=msg;
  }
  window.onerror = function (msg, src, line, col, err) {
    _inlineMsg('JS Error: ' + (err && err.message ? err.message : msg), false);
  };
  window.onunhandledrejection = function (e) {
    var r = e && e.reason; _inlineMsg('Promise Error: ' + (r && r.message ? r.message : r), false);
  };
  // Sanity check: are handlers present?
  document.addEventListener('DOMContentLoaded', function(){
    if (typeof window.authLogin !== 'function' ||
        typeof window.authSignup !== 'function' ||
        typeof window.authLogout !== 'function') {
      _inlineMsg('Auth handlers not found. Check that assets/auth.js loaded and contains SUPABASE_URL + anon key.', false);
    }
  });
</script>
</body>
</html>
